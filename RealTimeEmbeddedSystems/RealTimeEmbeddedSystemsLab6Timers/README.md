# Real-Time Embedded Systems Lab 6 – Timers

## Abstract:

The timers implemented in the hardware of the MSP432P401R Launchpad board and the corresponding interrupt are a very useful tool for consistently measuring time and performing required tasks accordingly. This experiment utilized and explored the MSP432P401R Launchpad board and the Keil uVision5 development environment with the purpose of extending the previous lab experiment and implementing a simple program to interact with the LEDs on the board using a configured timer as well as switch and timer interrupt service handlers.
For the initial setup for the program created in this experiment, the watchdog timer was firstly disabled. Then, the GPIO configuration and direction for input or output for each pin was set, the pull-up resistors for the pins for switches 1 and 2 were enabled, and the LED states were initialized to be in the off state. The switch interrupts were then configured by selecting the interrupt edge select for active low inputs, clearing the interrupt flag, and enabling the interrupt for the switches. The timer was configured by stopping the timer, clearing the timer interrupt flag, setting the value of the CCR0 register to ensure the clock counts the correct number of cycles to count 1 second, enabling the clock interrupt, setting the timer to up mode, and selecting the asynchronous clock. The NVIC was then configured for both the switch and clock interrupts, and global interrupts were enabled. Lastly, the main function was put in an infinite loop to continuously wait for an interrupt.
The system’s remaining logic was implemented inside the PORT1_IRQHandler and TA0_N_IRQHandler function. Inside the clock interrupt handler method, the clock interrupt flag was cleared, and the state of the currently selected LED was changed. Inside the switch interrupt handler method, conditional blocks were then used to determine which button was pressed using debouncing. If port 1’s interrupt flag was set to high due to a signal from pin 1 (switch 1 was pressed), the interrupt flag was cleared, and an XOR operation was done with the value of the current LED variable and 1 to alternate between the LEDs. If port 1’s interrupt flag was set to high due to a signal from pin 4 (switch 2 was pressed), the interrupt flag was cleared, and bit 4 of the timer flag was toggled to alternate between pausing the timer and resuming it by switching from stopped mode to up mode.
Therefore, through the completion of this lab, the basics of setting up the Launchpad board’s GPIO pins as input or output, the configuration and implementation of interrupt service routines, and the configuration and use of the timer hardware implemented in the board was learned.
