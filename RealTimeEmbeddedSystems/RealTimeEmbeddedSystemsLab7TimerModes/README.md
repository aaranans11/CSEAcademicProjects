# Real-Time Embedded Systems Lab 7 – Timer Modes

## Abstract:

The timers implemented in the hardware of the MSP432P401R Launchpad board and the corresponding interrupts are a very useful tool for consistently measuring time and performing required tasks accordingly. This experiment exercised practising timer configuration and interrupt service routine usage with the purpose of extending the previous lab experiment by implementing a program to make the LEDs of the board blink based on a sequence specified by a timing diagram.
For the initial setup for the program created in this experiment, the watchdog timer was firstly disabled. Then, the GPIO configuration and direction for each LED pin was set to configure them as outputs, the red LED was initialized to be on, and the RGB LED was initialized to be off. The timers were configured by stopping the timer, clearing the timer interrupt flag, enabling the clock interrupt, and selecting the asynchronous clock. Additionally, for the timer responsible for synchronizing the blinking of the red LED every 1 second, the value of the CCR0 register was set to ensure the clock counts the correct number of cycles to count 1 second, and the timer was set to up mode. To configure the timer for synchronizing the blinking of the RGB LED every 0.5 seconds with a 0.1 second offset at the start (TimerA1), the value of the TimerA1R counter register was overwritten to the correct number of clock cycles to count 0.4 seconds so that the first interrupt would occur 0.1 seconds after starting execution of the program, the value of the CCR0 register was set to ensure the clock counts the correct number of clock cycles to count 0.5 seconds, the timer was set to up/down mode. Additionally, the interrupt flag generated for counting up to the CCR0 value was cleared and the interrupt was enabled in the TimerA1CCTL0 register. The NVIC was then configured for the clock interrupts, and global interrupts were enabled. Lastly, the main function was put in an infinite loop to continuously wait for an interrupt.
The system’s remaining logic was implemented inside the TA0_N_IRQHandler, TA1_N_IRQHandler, and TA1_0_IRQHandler functions. Inside the TA0_N_IRQHandler function used for making the red LED blink, the clock interrupt flag was cleared, and the state of the red LED was toggled. The TA1_0_IRQHandler function was used to handle the interrupt when TimerA1 would count to 0.5 seconds, and the TA1_N_IRQHandler function was used to handle the interrupt when TimerA1 would count down from 0.5 seconds to 0. Both interrupt service handler routines used the same logic, clearing their respective interrupt flags and switching the state of the RGB LED.
Therefore, through the completion of this lab, the basics of setting up the Launchpad board’s GPIO pins as input or output, the configuration and implementation of interrupt service routines, and the configuration and use of the timer hardware implemented in the board was practiced.
